<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargar Receta - Rosita Admin</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script type="module">
        import { db } from './firebase-config.js';
        import { collection, addDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        window.db = db;
        window.addDoc = addDoc;
        window.collection = collection;
    </script>
</head>
<body>
    <div class="container">
        <header>
            <img src="images/logo-sin-fondo.png" alt="Rosita" class="logo-grande" style="max-width: 100px;">
            <h1>Cargar Receta</h1>
        </header>
        
        <nav>
            <a href="index.html">üè† Inicio</a>
            <a href="agregar-producto.html">‚ûï Agregar Producto</a>
            <a href="gestionar-productos.html">üìã Gestionar Productos</a>
            <a href="gestionar-precios.html">üí∞ Gestionar Precios</a>
            <a href="ver-pedidos.html">üì¶ Ver Pedidos</a>
            <a href="ver-clientes.html">üë• Ver Clientes</a>
            <a href="cargar-receta.html">üìù Cargar Receta</a>
        </nav>
        
        <main>
            <h2 class="page-title">Nueva Receta</h2>
            
            <div id="message"></div>
            
            <div class="form-container">
                <form id="recetaForm">
                    <div class="form-group">
                        <label for="titulo">T√≠tulo de la Receta *</label>
                        <input type="text" id="titulo" name="titulo" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="descripcion">Descripci√≥n</label>
                        <textarea id="descripcion" name="descripcion" rows="3" placeholder="Breve descripci√≥n de la receta..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="tiempo">Tiempo de Preparaci√≥n (minutos)</label>
                        <input type="number" id="tiempo" name="tiempo" min="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="porciones">Porciones</label>
                        <input type="number" id="porciones" name="porciones" min="1" value="4">
                    </div>
                    
                    <div class="form-group">
                        <label for="ingredientes">Ingredientes *</label>
                        <textarea id="ingredientes" name="ingredientes" rows="6" required placeholder="Lista los ingredientes, uno por l√≠nea:&#10;- 500g de carne&#10;- 2 cebollas&#10;- Sal y pimienta"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="instrucciones">Instrucciones *</label>
                        <textarea id="instrucciones" name="instrucciones" rows="10" required placeholder="Describe los pasos de preparaci√≥n, uno por l√≠nea:&#10;1. Cortar la carne en cubos&#10;2. Saltear las cebollas&#10;3. Agregar la carne..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="categoria">Categor√≠a</label>
                        <select id="categoria" name="categoria">
                            <option value="Carnes">Carnes</option>
                            <option value="Aves">Aves</option>
                            <option value="Asados">Asados</option>
                            <option value="Guisos">Guisos</option>
                            <option value="Otros">Otros</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn">Guardar Receta</button>
                    <button type="reset" class="btn btn-secondary" style="margin-left: 10px;">Limpiar Formulario</button>
                </form>
            </div>
        </main>
    </div>
    
    <script>
        const form = document.getElementById('recetaForm');
        const messageDiv = document.getElementById('message');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const receta = {
                titulo: document.getElementById('titulo').value,
                descripcion: document.getElementById('descripcion').value,
                tiempo: parseInt(document.getElementById('tiempo').value) || 0,
                porciones: parseInt(document.getElementById('porciones').value) || 4,
                ingredientes: document.getElementById('ingredientes').value,
                instrucciones: document.getElementById('instrucciones').value,
                categoria: document.getElementById('categoria').value,
                fechaCreacion: new Date().toISOString(),
                activa: true
            };
            
            try {
                await window.addDoc(window.collection(window.db, 'recetas'), receta);
                
                messageDiv.innerHTML = '<div class="message success">‚úÖ Receta guardada correctamente</div>';
                form.reset();
                
                setTimeout(() => {
                    messageDiv.innerHTML = '';
                }, 3000);
            } catch (error) {
                console.error('Error al guardar receta:', error);
                messageDiv.innerHTML = '<div class="message error">‚ùå Error al guardar la receta. Intente nuevamente.</div>';
            }
        });
    </script>
</body>
</html>

